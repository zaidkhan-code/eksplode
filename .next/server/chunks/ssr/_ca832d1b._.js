module.exports=[96221,a=>{"use strict";let b=(0,a.i(70106).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},84505,a=>{"use strict";let b=(0,a.i(70106).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);a.s(["Download",()=>b],84505)},16201,a=>{"use strict";let b=(0,a.i(70106).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],16201)},5050,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(20611),g=a.r(1722),h=a.r(38783)},74113,a=>{"use strict";var b=a.i(5050),c=(0,b.createServerReference)("40903c2bd2c23723e4a5b255fbd6e4221e804e58e3",b.callServer,void 0,b.findSourceMapURL,"uploadImageAction");a.s(["uploadImageAction",()=>c])},90166,a=>{"use strict";let b=(0,a.i(70106).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);a.s(["DollarSign",()=>b],90166)},97942,a=>{"use strict";var b=a.i(72131),c=a.i(7554),d=a.i(70121),e=a.i(50104),f=a.i(92843),g=a.i(25152),h=a.i(96743),i=a.i(22297),j=a.i(92616),k=a.i(77192),l=a.i(30553),m=a.i(86228),n=a.i(52081),o=a.i(41852),p=a.i(11011),q=a.i(87924),r="Dialog",[s,t]=(0,e.createContextScope)(r),[u,v]=s(r),w=a=>{let{__scopeDialog:c,children:d,open:e,defaultOpen:h,onOpenChange:i,modal:j=!0}=a,k=b.useRef(null),l=b.useRef(null),[m=!1,n]=(0,g.useControllableState)({prop:e,defaultProp:h,onChange:i});return(0,q.jsx)(u,{scope:c,triggerRef:k,contentRef:l,contentId:(0,f.useId)(),titleId:(0,f.useId)(),descriptionId:(0,f.useId)(),open:m,onOpenChange:n,onOpenToggle:b.useCallback(()=>n(a=>!a),[n]),modal:j,children:d})};w.displayName=r;var x="DialogTrigger";b.forwardRef((a,b)=>{let{__scopeDialog:e,...f}=a,g=v(x,e),h=(0,d.useComposedRefs)(b,g.triggerRef);return(0,q.jsx)(l.Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":g.open,"aria-controls":g.contentId,"data-state":P(g.open),...f,ref:h,onClick:(0,c.composeEventHandlers)(a.onClick,g.onOpenToggle)})}).displayName=x;var y="DialogPortal",[z,A]=s(y,{forceMount:void 0}),B=a=>{let{__scopeDialog:c,forceMount:d,children:e,container:f}=a,g=v(y,c);return(0,q.jsx)(z,{scope:c,forceMount:d,children:b.Children.map(e,a=>(0,q.jsx)(k.Presence,{present:d||g.open,children:(0,q.jsx)(j.Portal,{asChild:!0,container:f,children:a})}))})};B.displayName=y;var C="DialogOverlay",D=b.forwardRef((a,b)=>{let c=A(C,a.__scopeDialog),{forceMount:d=c.forceMount,...e}=a,f=v(C,a.__scopeDialog);return f.modal?(0,q.jsx)(k.Presence,{present:d||f.open,children:(0,q.jsx)(E,{...e,ref:b})}):null});D.displayName=C;var E=b.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=v(C,c);return(0,q.jsx)(n.RemoveScroll,{as:p.Slot,allowPinchZoom:!0,shards:[e.contentRef],children:(0,q.jsx)(l.Primitive.div,{"data-state":P(e.open),...d,ref:b,style:{pointerEvents:"auto",...d.style}})})}),F="DialogContent",G=b.forwardRef((a,b)=>{let c=A(F,a.__scopeDialog),{forceMount:d=c.forceMount,...e}=a,f=v(F,a.__scopeDialog);return(0,q.jsx)(k.Presence,{present:d||f.open,children:f.modal?(0,q.jsx)(H,{...e,ref:b}):(0,q.jsx)(I,{...e,ref:b})})});G.displayName=F;var H=b.forwardRef((a,e)=>{let f=v(F,a.__scopeDialog),g=b.useRef(null),h=(0,d.useComposedRefs)(e,f.contentRef,g);return b.useEffect(()=>{let a=g.current;if(a)return(0,o.hideOthers)(a)},[]),(0,q.jsx)(J,{...a,ref:h,trapFocus:f.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,c.composeEventHandlers)(a.onCloseAutoFocus,a=>{a.preventDefault(),f.triggerRef.current?.focus()}),onPointerDownOutside:(0,c.composeEventHandlers)(a.onPointerDownOutside,a=>{let b=a.detail.originalEvent,c=0===b.button&&!0===b.ctrlKey;(2===b.button||c)&&a.preventDefault()}),onFocusOutside:(0,c.composeEventHandlers)(a.onFocusOutside,a=>a.preventDefault())})}),I=b.forwardRef((a,c)=>{let d=v(F,a.__scopeDialog),e=b.useRef(!1),f=b.useRef(!1);return(0,q.jsx)(J,{...a,ref:c,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:b=>{a.onCloseAutoFocus?.(b),b.defaultPrevented||(e.current||d.triggerRef.current?.focus(),b.preventDefault()),e.current=!1,f.current=!1},onInteractOutside:b=>{a.onInteractOutside?.(b),b.defaultPrevented||(e.current=!0,"pointerdown"===b.detail.originalEvent.type&&(f.current=!0));let c=b.target;d.triggerRef.current?.contains(c)&&b.preventDefault(),"focusin"===b.detail.originalEvent.type&&f.current&&b.preventDefault()}})}),J=b.forwardRef((a,c)=>{let{__scopeDialog:e,trapFocus:f,onOpenAutoFocus:g,onCloseAutoFocus:j,...k}=a,l=v(F,e),n=b.useRef(null),o=(0,d.useComposedRefs)(c,n);return(0,m.useFocusGuards)(),(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(i.FocusScope,{asChild:!0,loop:!0,trapped:f,onMountAutoFocus:g,onUnmountAutoFocus:j,children:(0,q.jsx)(h.DismissableLayer,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":P(l.open),...k,ref:o,onDismiss:()=>l.onOpenChange(!1)})}),(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(T,{titleId:l.titleId}),(0,q.jsx)(U,{contentRef:n,descriptionId:l.descriptionId})]})]})}),K="DialogTitle",L=b.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=v(K,c);return(0,q.jsx)(l.Primitive.h2,{id:e.titleId,...d,ref:b})});L.displayName=K;var M="DialogDescription";b.forwardRef((a,b)=>{let{__scopeDialog:c,...d}=a,e=v(M,c);return(0,q.jsx)(l.Primitive.p,{id:e.descriptionId,...d,ref:b})}).displayName=M;var N="DialogClose",O=b.forwardRef((a,b)=>{let{__scopeDialog:d,...e}=a,f=v(N,d);return(0,q.jsx)(l.Primitive.button,{type:"button",...e,ref:b,onClick:(0,c.composeEventHandlers)(a.onClick,()=>f.onOpenChange(!1))})});function P(a){return a?"open":"closed"}O.displayName=N;var Q="DialogTitleWarning",[R,S]=(0,e.createContext)(Q,{contentName:F,titleName:K,docsSlug:"dialog"}),T=({titleId:a})=>{let c=S(Q),d=`\`${c.contentName}\` requires a \`${c.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${c.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${c.docsSlug}`;return b.useEffect(()=>{a&&(document.getElementById(a)||console.error(d))},[d,a]),null},U=({contentRef:a,descriptionId:c})=>{let d=S("DialogDescriptionWarning"),e=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${d.contentName}}.`;return b.useEffect(()=>{let b=a.current?.getAttribute("aria-describedby");c&&b&&(document.getElementById(c)||console.warn(e))},[e,a,c]),null};a.s(["Close",()=>O,"Content",()=>G,"Overlay",()=>D,"Portal",()=>B,"Root",()=>w,"Title",()=>L])},13049,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(40695),e=a.i(5522),f=a.i(54161),g=a.i(88819),h=a.i(86875),i=a.i(97895),j=a.i(81464),k=a.i(84505),l=a.i(87532),m=a.i(23292),n=a.i(90725),o=a.i(90166),p=a.i(33508),q=a.i(16201),r=a.i(96221);function s({selectedRows:a,setOpenPaymentModal:e,onClose:f,fetchLedger:g}){let[h,i]=(0,c.useState)(!1),j=a?.map(a=>a?._id);return(0,b.jsx)("div",{className:`fixed top-0 left-0 right-0 z-50 overflow-hidden transition-all duration-500 ease-in-out
        ${a?.length>0?"max-h-40 sm:max-h-24 opacity-100 translate-y-0":"max-h-0 -translate-y-full"}
      `,children:(0,b.jsxs)("div",{className:"bg-gray-900/95 backdrop-blur-md p-3 sm:p-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 border-b border-red-500/20 shadow-lg",children:[(0,b.jsxs)("span",{className:"text-white font-medium text-sm sm:text-base",children:[a?.length," selected"]}),(0,b.jsxs)("div",{className:"   grid grid-cols-2 sm:flex    gap-2 w-full sm:w-auto   ",children:[(0,b.jsxs)(d.Button,{onClick:()=>{e(!0)},className:"bg-green-600 hover:bg-green-700 flex items-center gap-1 justify-center text-sm",children:[(0,b.jsx)(o.DollarSign,{size:16}),(0,b.jsx)("span",{className:"hidden sm:block",children:"Mark as Paid"}),(0,b.jsx)("span",{className:"sm:hidden",children:"Paid"})]}),(0,b.jsxs)(d.Button,{onClick:function(){i(!0),(0,n.default)("admin/bulk-Update-Ledger-Status",{method:"POST",headers:{"Content-Type":"application/json"},data:{ledgerIds:j,status:"available"}},(a,b)=>{i(!1),b?(m.toast.success("ledger is successfully updated!"),g(),f()):m.toast.error(a?.message)})},disabled:h,className:"bg-blue-600 hover:bg-blue-700 flex items-center gap-1 justify-center text-sm disabled:opacity-70",children:[h?(0,b.jsx)(r.Loader2,{size:16,className:"animate-spin"}):(0,b.jsx)(q.CheckCircle,{size:16}),(0,b.jsx)("span",{className:"hidden sm:block",children:h?"Updating...":"Mark as Available"}),(0,b.jsx)("span",{className:"sm:hidden",children:h?"...":"Available"})]}),(0,b.jsx)(d.Button,{onClick:f,variant:"ghost",className:"hover:bg-gray-800 bg-gray-700 text-white rounded-full w-10 h-10 flex items-center justify-center",children:(0,b.jsx)(p.X,{size:18})})]})]})})}var t=a.i(97942),u=a.i(74113);function v({open:a,selectedRows:f=[],onClose:g,fetchLedger:h}){let[j,k]=c.useState(""),[l,o]=c.useState(""),[q,r]=c.useState({}),[s,v]=c.useState({}),[w,x]=c.useState(!1),y=c.useMemo(()=>{let a=new Map;return f.forEach(b=>{let c=b.userId._id;if(a.has(c)){let d=a.get(c);d.amountCents+=b.amountCents||0,d.ledgerIds.push(b._id)}else a.set(c,{userId:c,name:b.userId.name,amountCents:b.amountCents||0,ledgerIds:[b._id],zellePaymentDetails:b.userId.zellePaymentDetails})}),Array.from(a.values())},[f]),z=c.useMemo(()=>f.reduce((a,b)=>a+(b.amountCents||0),0),[f]),A=async(a,b)=>{let c=a.target.files?.[0];if(c){if(c.size>1048576)return void m.toast.error("File too large. Max size is 1MB.");if(!["image/png","image/jpeg","image/jpg","image/webp","application/pdf"].includes(c.type))return void m.toast.error("Only images or PDF allowed.");r(a=>({...a,[b]:!0}));try{let a=new FormData;a.append("image",c);let d=await (0,u.uploadImageAction)(a);d?.url?(v(a=>({...a,[b]:d.url})),m.toast.success(`Proof uploaded for ${b}`)):m.toast.error("Upload failed.")}catch(a){m.toast.error("Upload failed.")}finally{r(a=>({...a,[b]:!1}))}}};return(0,b.jsx)(t.Root,{open:a,children:(0,b.jsx)(t.Portal,{children:(0,b.jsx)("div",{className:"fixed inset-0 flex z-[999999999] items-center justify-center p-4",children:(0,b.jsxs)(t.Content,{className:"   w-full max-w-3xl max-h-[80vh] rounded-2xl bg-zinc-900 text-zinc-100    border border-zinc-800 shadow-2xl p-6 overflow-y-auto   ",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)(t.Title,{className:"text-xl font-bold",children:"Bulk Payment Summary"}),(0,b.jsx)(t.Close,{asChild:!0,children:(0,b.jsx)("button",{className:"text-zinc-400 hover:text-white",onClick:g,children:(0,b.jsx)(p.X,{size:22})})})]}),(0,b.jsxs)("div",{className:"bg-zinc-800/60 rounded-lg p-4 mb-4 border border-zinc-700 max-h-80 overflow-y-auto",children:[(0,b.jsx)("p",{className:"text-sm font-semibold mb-2",children:"Selected Users"}),y.length>0?(0,b.jsx)("ul",{className:"text-sm divide-y divide-zinc-700/50",children:y.map(a=>(0,b.jsxs)("li",{className:"py-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-semibold",children:a.name}),(0,b.jsxs)("div",{className:"text-xs text-zinc-400",children:[a.ledgerIds.length," ledger(s)"]}),a.zellePaymentDetails&&(0,b.jsxs)("div",{className:"mt-1 text-xs text-blue-300",children:["Payment Details",(0,b.jsxs)("div",{children:["Email: ",a.zellePaymentDetails.email||"—"]}),(0,b.jsxs)("div",{children:["Phone:"," ",a.zellePaymentDetails.phoneNumber||"—"]})]})]}),(0,b.jsx)("div",{className:"text-green-400 font-semibold",children:(0,i.formatCurrency)(a.amountCents)})]}),(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsx)("input",{type:"file",accept:"image/*,application/pdf",onChange:b=>A(b,a.userId),className:"w-full text-xs text-zinc-400    file:px-4 file:py-2 file:rounded-md    file:bg-blue-600 file:text-white hover:file:bg-blue-700"}),q[a.userId]&&(0,b.jsx)("p",{className:"text-xs text-blue-400 mt-1",children:"Uploading..."}),s[a.userId]&&(0,b.jsx)("div",{className:"mt-2",children:s[a.userId].endsWith(".pdf")?(0,b.jsx)("a",{href:s[a.userId],target:"_blank",className:"text-xs underline",children:"Open PDF proof"}):(0,b.jsx)("img",{src:s[a.userId],className:"w-28 h-28 rounded-lg border border-zinc-700 object-cover"})})]})]},a.userId))}):(0,b.jsx)("p",{className:"text-sm text-zinc-500",children:"No users selected"})]}),(0,b.jsxs)("div",{className:"mb-4 text-sm",children:[(0,b.jsx)("span",{className:"font-medium",children:"Total Balance: "}),(0,b.jsx)("span",{className:"text-green-400 font-semibold",children:(0,i.formatCurrency)(z)})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm mb-1 text-zinc-400",children:"Payment Method"}),(0,b.jsx)(e.Input,{value:l,onChange:a=>o(a.target.value),placeholder:"Bank Transfer, Walmart, etc."})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm mb-1 text-zinc-400",children:"Notes"}),(0,b.jsx)("textarea",{value:j,onChange:a=>k(a.target.value),className:"w-full h-24 text-sm rounded-md bg-zinc-800 border border-zinc-700 p-2",placeholder:"Notes for all users..."})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,b.jsx)(d.Button,{variant:"ghost",onClick:g,children:"Cancel"}),(0,b.jsx)(d.Button,{disabled:w,onClick:()=>{if(w)return;x(!0);let a=y.map(a=>({userId:a.userId,ledgerIds:a.ledgerIds,amountCents:a.amountCents,proofUrl:s[a.userId]||null,notes:j}));(0,n.default)("admin/bulk-update-ledger",{method:"POST",headers:{"Content-Type":"application/json"},data:{paymentMethod:l,users:a}},(a,b)=>{b?(m.toast.success("Payouts created successfully!"),g(),h(),k(""),o(""),v({}),x(!1)):(x(!1),m.toast.error(a?.message))})},children:w?"Processing...":"Create Payouts & Mark Paid"})]})]})})})})}function w(){let[a,o]=(0,c.useState)([]),[p,q]=(0,c.useState)("all"),[r,t]=(0,c.useState)(""),[u,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(1),[z]=(0,c.useState)(20),[A,B]=(0,c.useState)(1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)([]),G=(a=1)=>{w(!0),(0,n.default)(`admin/ledger?page=${a}&limit=${z}${"all"!==p?`&status=${p}`:""}${r?`&userId=${r}`:""}`,{method:"GET"},(a,b)=>{w(!1),b&&a.success?(o(a.entries),y(a.currentPage),B(a.totalPages)):m.toast.error(a?.message||"Failed to fetch ledger!")})};function H(){D(!1),F([])}(0,c.useEffect)(()=>{G(1)},[p,r]);let I=[{key:"userName",label:"User Name",render:(a,b)=>b.userId.name},{key:"userName",label:"Email",render:(a,b)=>b.userId.email},{key:"amountCents",label:"Amount",render:(a,c)=>(0,b.jsxs)("span",{className:"credit"===c.type?"text-green-400":"text-red-400",children:["credit"===c.type?"+":"-",(0,i.formatCurrency)(c.amountCents)]})},{key:"status",label:"Status",render:a=>(0,b.jsx)(f.Badge,{className:`${{pending:"bg-yellow-600",available:"bg-green-600",paid:"bg-blue-600"}[a]} text-white`,children:a})},{key:"notes",label:"Notes"},{key:"createdAt",label:"Date",render:a=>(0,i.formatDate)(a)}];return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"min-h-screen bg-black relative",children:[(0,b.jsx)(g.PageHeader,{title:"Ledger",description:"View all system transactions",action:(0,b.jsxs)(d.Button,{className:"gap-2 bg-red-600 hover:bg-red-700",children:[(0,b.jsx)(k.Download,{className:"w-4 h-4"}),"Export"]})}),(0,b.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex gap-2 flex-wrap",children:(0,b.jsxs)("div",{className:"flex-1 min-w-64 relative",children:[(0,b.jsx)(l.Search,{className:"absolute left-3 top-3 w-4 h-4 text-gray-400"}),(0,b.jsx)(e.Input,{placeholder:"Search by username or user ID...",value:r,onChange:a=>t(a.target.value),className:"pl-10 bg-black border-red-500/20 text-white"})]})}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsxs)(d.Button,{onClick:()=>q("all"),className:"all"===p?"bg-red-600 hover:bg-red-700":"border-red-500/30 text-gray-400 hover:text-white hover:bg-red-900/20",children:[(0,b.jsx)(j.Filter,{className:"w-4 h-4"}),"All Entries"]}),["pending","available","paid"].map(a=>(0,b.jsx)(d.Button,{onClick:()=>q(a),className:p===a?"bg-red-600 hover:bg-red-700":"border-red-500/30 text-gray-400 hover:text-white hover:bg-red-900/20",children:a.charAt(0).toUpperCase()+a.slice(1)},a))]}),(0,b.jsx)(h.DataTable,{data:a.map(a=>({...a,id:a._id})),loading:u,columns:I,currentPage:x,selectedRows:E,totalPages:A,enableCheckbox:!0,onRowSelect:a=>{F(a)},onPageChange:a=>{G(a)}})]})})]}),(0,b.jsx)(s,{selectedRows:E,onClose:H,setOpenPaymentModal:D,fetchLedger:G}),(0,b.jsx)(v,{selectedRows:E,open:C,fetchLedger:G,onClose:H})]})}a.s(["default",()=>w],13049)}];

//# sourceMappingURL=_ca832d1b._.js.map